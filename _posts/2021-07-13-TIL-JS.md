---
layout: post
title: "Node.JS ê¸°ì´ˆ ğŸ’¬"
date: 2021-07-13
categories: TIL JavaScript express.js node.js
---

ìë°”ìŠ¤í¬ë¦½íŠ¸ì€ ë¸Œë¼ìš°ì € ì•ˆì—ì„œ ëŒì•„ê°€ëŠ” ì–¸ì–´ì´ë‹¤ ë¸Œë¼ìš°ì € ë°–ì—ì„œ ì´ê²ƒì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ **Node.JS(ëŸ°íƒ€ì„ í™˜ê²½)**ì´ í•„ìš”í•˜ë‹¤

# Node.JS êµ¬ì¡°

![](https://images.velog.io/images/action2thefuture/post/bce90b76-5951-47e6-bfbb-0b74943295df/node.js-architecture.png)

## ì‹±ê¸€ ì“°ë ˆë“œ / ì´ë²¤íŠ¸ ë£¨í”„

![](https://images.velog.io/images/action2thefuture/post/8793b397-fbb5-44b2-8201-dc18bbab4a68/NodeJS%20event%20loop.png)
JSëŠ” ë¹„ë™ê¸° ê¸°ë°˜ì˜ ì–¸ì–´ì´ë‹¤ í•˜ë‚˜ì˜ ì“°ë ˆë“œë¡œ ì—¬ëŸ¬ Clientì˜ ìš”ì²­ì„ ë°›ê³  ì‘ë‹µì„ í•´ì¤€ë‹¤

ë¹„ë™ê¸° ê¸°ë°˜(Non-Blocking I/O)ì˜ ì–¸ì–´ì—¬ì„œ ì½œë°±í•¨ìˆ˜ì™€ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ë¥¼ ì§€ì •ì„ í•´ì¤˜ì•¼í•œë‹¤

í•˜ë‚˜ì˜ ì“°ë ˆë“œë¡œ ì—°ì‚°ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë³µì¡í•œ ì—°ì‚°ì²˜ë¦¬ê°€ ìˆì„ ì‹œ ì–´ë ¤ì›€ì— ì§ë©´í•˜ê±°ë‚˜ ì—ëŸ¬ê°€ ë°œìƒí•  ì‹œ ì„œë²„ê°€ ë©ˆì¶”ëŠ” ë‹¨ì ì´ ìˆë‹¤

### Node.JSë¡œ ì„œë²„ êµ¬ë™í•˜ê¸°

Express í”„ë ˆì„ì›Œí¬ë¡œ ì„œë²„ë¥¼ êµ¬ë™í•  ìˆ˜ ìˆë‹¤
morgan ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ í„°ë¯¸ë„ì— ì˜¤ë¥˜ì‚¬í•­ì„ ë‚˜ì˜¤ë„ë¡ í•  ìˆ˜ ìˆë‹¤

```javascript
const express = require("express");
const morgan = require("morgan");

const app = express();

const port = process.env.PORT || 5000;
const host = process.env.HOST || "0.0.0.0";

app.listen({ port, host }),
  async () => {
    try {
      await console.log(`Server is running on port ${port}`);
    } catch (err) {
      await console.log(`${err}`);
    }
  };
```

## Router / Controller / Model

Node.JSë¡œ íš¨ìœ¨ì ì¸ ìš´ì˜ì„ ìœ„í•˜ì—¬ ê³„ì¸µêµ¬ì¡°ë¥¼ ë‚˜ëˆ„ì–´ì•¼í•œë‹¤

Routerë¡œ URlì„ ë‚˜ëˆ„ê³  Controllerë¡œ ë¡œì§ì„ êµ¬ì„±í•œë‹¤

#### ./routes/index.js

```javascript
const router = require("express").Router();
const controller = require("./controllers");

router.get("/router", controller);

module.exports = router;
```

#### app.js

```javascript
const express = require("express");
const morgan = require("morgan");

const Router = require("./routes");

const app = express();

const port = process.env.PORT || 5000;
const host = process.env.HOST || "0.0.0.0";

app.listen({ port, host }),
  async () => {
    try {
      await console.log(`Server is running on port ${port}`);
    } catch (err) {
      await console.log(`${err}`);
    }
  };
```

#### ./controllers/index.js

```javascript
module.exports = { async (req, res, next) => {
  return res.json({'Hi'})
}
```

## Middleware

ìš”ì²­ê³¼ ì‘ë‹µì‚¬ì´ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ì¼ì¢…ì˜ ìµœì†Œí•œ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ì–´ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤
`Express.JS`ì—ì„œ `use`í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤

```javascript
app.use(express.urlencoded({ extended: false }));
// url ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì„ parsing(req.body)

app.use(express.json());
// jsonìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆë‹¤

app.use(morgan("dev"));
// ì˜¤ë¥˜ì‚¬í•­ì„ í„°ë¯¸ë„ ë‚´ì— ë‚˜íƒ€ë‚´ê²Œ í•´ì¤€ë‹¤
```

### next

```javascript
const express = require("express");

const app = express();

app.get(
  "/",
  (req, res, next) => {
    next();
  },
  (req, res) => {
    res.send("Hello");
  }
);

app.listen({ port, host }),
  async () => {
    try {
      await console.log(`Server is running on port ${port}`);
    } catch (err) {
      await console.log(`${err}`);
    }
  };
```

next í•¨ìˆ˜ëŠ” ë‹¤ìŒ ì½œë°± í•¨ìˆ˜ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆê²Œ ë„ì™€ì¤€ë‹¤
next ë‚´ì— íŒŒë¼ë¯¸í„°ê°€ ì¡´ì¬í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤
nextë¥¼ ì´ìš©í•˜ì—¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤

## í™˜ê²½ë³€ìˆ˜

### .env

`dotenv`ë¥¼ ì´ìš©í•˜ì—¬ ìˆ¨ê¸´ íŒŒì¼(.env)ì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì €ì¥í•˜ì—¬ ë“œëŸ¬ë‚˜ì§€ ì•Šê²Œ í•œë‹¤

```JS
require("dotenv").config();

// .envì— ì €ì¥ë˜ì–´ ìˆëŠ” í™˜ê²½ë³€ìˆ˜ëŠ”
// process.env.{í™˜ê²½ë³€ìˆ˜}ë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤
```

## Path

```javascript
const path = require("path");

// í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ íŒŒì¼ ê²½ë¡œ
__filename;

// í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ë””ë ‰í† ë¦¬
__dirname;

// ê²½ë¡œ ì—°ê²°
path.join(__dirname, "/test");

// ìƒëŒ€ì ì¸ ê²½ë¡œë¡œ ì—°ê²°.
path.resolve("/controllers", "./user");

// ê²½ë¡œì— í•´ë‹¹í•˜ëŠ” ì†ì„±ì„ ê°€ì ¸ì˜¨ë‹¤.
path.parse(root, dir, base, ext, name);
```
