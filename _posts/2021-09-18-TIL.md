---
layout: post
title: "Jenkins ê¸°ì´ˆğŸ’¬"
date: 2021-09-18
categories: TIL Jenkins CI/CD Dockerhub EC2
---

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkins.jpeg)

# JenKins

CI/CDì— ëŒ€í‘œì ì¸ íˆ´  
ìë°” ëŸ°íƒ€ì„ í™˜ê²½ ê¸°ë°˜ì˜ ì˜¤í”ˆì†ŒìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´  
ìë°” ì„¤ì¹˜  
[ë§í¬](https://davelogs.tistory.com/71)

ìë°” ê¸°ë³¸ PortëŠ” 8080  
ê·¸ëŸ¬ë¯€ë¡œ ì  í‚¨ìŠ¤ì„œë²„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 8080 Portì—ì„œ ëŒì•„ê°„ë‹¤

ëª¨ë“  ì‘ì—…ë“¤ì— ëŒ€í•œ ìë™ Build, Test, Deliver(=Deploy) ì´ ê°€ëŠ¥í•˜ë‹¤  
Gitê³¼ ì—°ë™í•˜ì—¬ ë¹Œë“œë¥¼ í†µí•˜ì—¬ ê°œë°œê³¼ ë°°í¬ë¥¼ ë„ì™€ì¤€ë‹¤  
Pluginì„ ì„¤ì¹˜í•˜ì—¬ ìƒˆë¡œìš´ í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkinsdocker.png)

## ì  í‚¨ìŠ¤ ì‹œì‘í•˜ê¸°

[Jenkins ë‹¤ìš´ë¡œë“œ](https://www.jenkins.io/download/)

ìš°ë¶„íˆ¬ì—ì„œ  
`sudo service jenkins start`ë¡œ ì„œë²„ë¥¼ ì‹¤í–‰í•œë‹¤

**jenkin ëª…ë ¹ì–´**  
`service jenkins {start|stop|status|restart|force-reload}`

`/var/lib/jenkins/secrets/initialAdminPassword`  
ìœ„ì¹˜ì—ì„œ admin ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤

**Jenkins ë¡œê·¸ì¸ ë¹„í™œì„±í™”**

`sudo vi /var/lib/jenkins/config.xml`

vimì„ í†µí•´ í•´ë‹¹ íŒŒì¼ì— ë“¤ì–´ê°€ì„œ ì„¤ì •ì„ ë°”ê¿”ì¤€ë‹¤

```java
<useSecurity>false</useSecurity>
```

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/admin.png)
ì²˜ìŒì— ë“¤ì–´ê°€ë©´ admin íšŒì›ê°€ì…ì„ í•  ìˆ˜ ìˆë‹¤  
í•´ë‹¹ ë‚´ìš©ì„ skip ê°€ëŠ¥í•˜ë‹¤

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jekinsurl.png)
jekins urlë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkinssystem.png)
ì  í‚¨ìŠ¤ì˜ ë©”ì¸í™”ë©´ì´ë‹¤  
ì—¬ê¸°ì„œ í™˜ê²½ì„¤ì •, í”ŒëŸ¬ê·¸ì¸, ë…¸ë“œì„¤ì • ë“± ì  í‚¨ìŠ¤ì˜ ì „ë°˜ì ì¸ ì„¤ì •ë“¤ì„ í•  ìˆ˜ ìˆë‹¤  
ê° í”„ë¡œì íŠ¸ì•  ëŒ€í•œ ì „ì²´ì ì¸ ì„¤ì •ì€ ì—¬ê¸°ì„œ í•  ìˆ˜ ìˆê³  ì„¸ë¶€ì ì¸ ì„¤ì •ì€ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“  í›„ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤

## DockerHub ì—°ë™í•˜ê¸°

Dockerë¥¼ í†µí•˜ì—¬ ë°°í¬ë¥¼ í•˜ë©´ ì—°ë™ëœ Jenkinë¥¼ í†µí•˜ì—¬ ìë™í™”ëœ ë²„ì „ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤

**ì—°ê²°ê³¼ì •**  
Dockerë¡œ DockerHubì— pushë¥¼ í•˜ë©´ webhookì„ í†µí•´ pushëœ ë¹Œë“œëœ Dockerë¥¼  
EC2ì—ì„œ ë„ì–´ì§„ ì  í‚¨ìŠ¤ê°€ ê°ì§€ë¥¼ í•œë‹¤ ìë™ì ìœ¼ë¡œ Dockerë¥¼ pullë°›ì€ ë’¤ ë°°í¬ë¥¼ í•œë‹¤  
(ì´ëŸ¬í•œ ê³¼ì •ì€ ì  í‚¨ìŠ¤ì— ì„¤ì¹˜ëœ Pluginìœ¼ë¡œ ê°€ëŠ¥í•œ ë¶€ë¶„ì´ë‹¤)

DocekrHubì™€ ì—°ë™í•˜ê¸° ìœ„í•´ì„œ  
`CloudBees Docker Hub/Registry Notification`ë¼ëŠ” pluginì´ í•„ìš”í•˜ë‹¤ ì„¤ì¹˜ë¥¼ í•˜ê³  ì§„í–‰í•´ë³´ì  
ì—¬ê¸°ì„œ Dockerë¥¼ ë¹Œë“œë¥¼ í•˜ê³  ë°°í¬ë¥¼ í•˜ëŠ” ê³¼ì •ì¸ CI/CDì´ë‹¤

### terminal docker permisiion denied

```bash
dial unix /var/run/docker.sock: connect: permission denied
```

ì  í‚¨ìŠ¤ ì„œë²„ì— ë„ì»¤ê·¸ë£¹ì„ ì¶”ê°€í•´ì¤€ë‹¤

`sudo usermod -aG docker jenkins`

**build ì„¤ì •**  
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jekinsbuild.png)
Monitor Docker Hub/Registry for image changes : Docker webhook í™œì„±í™”  
Any referenced Docker image can trigger this job  
Specified repositories will trigger this job : Dockerhubì˜ ê¹ƒí—ˆë¸Œì£¼ì†Œ ë“±ë¡

## GithHub ì—°ë™í•˜ê¸°

ê¹ƒí—ˆë¸Œì™€ ì  í‚¨ìŠ¤ë¥¼ ì—°ë™í•´ë³´ì  
dockerì˜ ì„¤ì •ê³¼ ë¹„ìŠ·í•˜ê²Œ ë¡œì»¬ì„œë²„ì—ì„œ githubì— pushë¥¼ í•˜ë©´ webhookì„ í†µí•´ pushëœ gitì€
EC2ì—ì„œ ë„ì–´ì§„ ì  í‚¨ìŠ¤ê°€ ê°ì§€ë¥¼ í•˜ê³  ìë™ì ìœ¼ë¡œ gitì„ pullë°›ëŠ”ë‹¤  
github pluginì€ ì´ˆê¸°ì„¸íŒ… pluginìœ¼ë¡œ ìë™ì ìœ¼ë¡œ ì„¤ì¹˜ê°€ ë˜ì–´ìˆë‹¤

**github urlê³¼ ì—°ê²°**
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/githubserverurl.png)

**github source code ì—°ê²°**
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/githubsourcecode.png)

**github scopeì„¤ì •**  
develop settingì—ì„œ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/githubscope.png)

**github tokenlist**  
í•´ë‹¹ ì‚¬ì§„ì€ tokenlistê°€ ë‹´ê¸´ ì‚¬ì§„ì´ë‹¤
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/githubtoken.png)

ìƒˆë¡œìš´ tokenì„ ë§Œë“¤ì–´ë³´ì  
tokenì„ í†µí•˜ì—¬ jenkinsì™€ ì—°ê²°ì„ í•´ì•¼í•œë‹¤ ê¸°ë³¸ì ì€ ë³´ì•ˆì´ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ë§‰ë¬´ê°€ë‚´ë¡œ ì—°ê²°ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤  
ì  í‚¨ìŠ¤ì— webhookìœ¼ë¡œ ì—°ê²°í•˜ê¸°ìœ„í•œ github repoì˜ í† í°ìœ¼ë¡œ ì—°ê²°ì„ í•´ì•¼í•œë‹¤

**githun token ìƒì„±**  
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/tokengenerate.png)
í† í°ì´ ë§Œë“¤ì–´ì¡Œìœ¼ë‹ˆ ì  í‚¨ìŠ¤ì™€ ì—°ê±¸í•´ë³´ì

**ì  í‚¨ìŠ¤ì— github repoë“±ë¡**
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jekinstoken.png)

**build ì„¤ì •**  
![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkinsbuild.png)
GitHub hook trigger for GITScm polling : Github webhook í™œì„±í™”

## Build

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkinsconsole.png)
build nowì„ í´ë¦­í•˜ë©´ build scrpitì— ì„¤ì •í•œ ë‚´ìš©ë“¤ì´ ì‹¤í–‰ëœë‹¤
í•´ë‹¹ ë‚´ìš©ì€ docker pullì„ ì‹¤í–‰í–ˆë‹¤ëŠ” ë‚´ìš©ì´ë‹¤

![](https://raw.githubusercontent.com/Action2theFuture/Action2theFuture.github.io/main/_posts/Images/jenkinsconsole3.png)
git pushë¥¼ í•˜ë‹ˆ ìë™ì ìœ¼ë¡œ buildë¥¼ ì‹¤í–‰í•˜ì˜€ë‹¤ webhookì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆë‹¤

**Jenkins CSS Broken**
Jenkins ë©”ì¸ í˜ì´ì§€ì—ì„œ Jenkins ê´€ë¦¬ >> ë…¸ë“œ ê´€ë¦¬ >> ì½˜ì†” ì°½ì—

```
System.setProperty("hudson.model.DirectoryBrowserSupport.CSP", "")
```

ì‘ì„±ì„ í•˜ë©´ CSSê°€ ê¹¨ì§€ëŠ” ê²ƒì„ í•´ê²°í•˜ê²Œ ëœë‹¤  
[Jenkins CSS broken StackOverflow](https://stackoverflow.com/questions/35783964/jenkins-html-publisher-plugin-no-css-is-displayed-when-report-is-viewed-in-j)

## EC2

EC2 Permission error  
[ë§í¬](https://techsoda.net/windows10-pem-file-permission-settings/)

ë³¼ë¥¨ ë§ˆìš´íŠ¸  
[ë§í¬](https://minjii-ya.tistory.com/27)
