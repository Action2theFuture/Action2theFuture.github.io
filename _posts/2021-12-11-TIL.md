---
layout: post
title: "방화벽 iptables/ufw Netstat"
date: 2021-12-11
categories: TIL FireWall 방화벽
---

## Linux에서 사용하는 방화벽 툴

### iptables 

- 방화벽 리스트 확인
```bash
$ iptables -L

Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
```

- port open
```bash
$ iptables - P INPUT ACCEPT
$ iptables - P OUTPUT ACCEPT
$ iptables - P FORWARD ACCEPT
```

- Reset
```bash
$ iptables -F
```

- chain print
```bash
$ iptables -nL
```

- Insert
```bash
$ iptables -I OUTPUT 
$ iptabels -I INPUT
```

- destination / source
```bash
$ iptables -d localhost
$ iptables -s localhost
```

- destination port / source port
```bash
$ iptables -p tcp --dport [port]
$ iptables -p tcp --sport [port]
```

- 처리할 목적
```bash
$ iptables -j ACCEPT
$ iptables -j REJECT
$ iptables -j DROP
```
- Delete
```bash
$ iptables -D INPUT [list_number]
```

- 모든 네트워크 입출입 차단

```bash
$ iptables --policy INPUT DROP
$ iptables --policy OUTPUT DROP
$ iptables --policy FORWARD DROP
```

[iptables example](https://www.lesstif.com/system-admin/20-iptables-17104956.html)
[iptables option](https://blessu1201.github.io/2020/09/08/iptables.html)

### ufw

iptables보다 간편하고 쉽게 사용할 수 있다  
하지만 간편한 만큼 좀더 디테일한 방화벽을 만들기 위해선 iptables도 공부할 필요가 있다

- 방화벽 켜기
```bash
$ ufw enable
```

- 방화벽 끄기
```bash
$ ufw disable
```

- 특정 port allow
```bash
$ ufw allowd [port]/tcp
```

- 특정 port deny
```bash
$ ufw deny [port]/tcp
```

- 규칙 제거
```bash
$ ufw delete allow [port]
$ ufw delete deny [port]
```

- status
```bash
ufw status
```

## Netplan 고정 ip 설정


```yaml
network:
  version: 2
    renderer: NetworkManager
    ethernets:
      wlp5s0:
      // interface 이름
        dhcp4: no
        // 고정 ip를 위한 설정
        addresses: [address1]
        gatway4: gatway_address
        nameserver:
          address: [8.8.8.8,8.8.4.4]
          // 구글 DNS
```

- 변경된 설정 적용
```bash
$ netplan apply
```

- 설정 확인
```bash
$ ifconfig -a
```

- 정상 동작 여부 확인
```bash
$ nslookup google.com
```
